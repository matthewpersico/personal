#!/usr/bin/env bash
## shellcheck disable=SC2164 # we take care of cd checks ourselves.

# <Function Class: cd>
# <Function Justification: env mod>

_dirlist_select ()
{
    local PS3="Choose by number, - for prior, q to quit: "
    local d
    select d in "$@"
    do
        if [ -n "$d" ]
        then
            d="$(echo "$d" | sed "s|$DIRLIST_PWD_INDIC||" | sed "s|\\~|$HOME|")"
            if [ -d "$d" ]
            then
                # shellcheck disable=SC2164
                builtin cd "$d"
                break
            else
                echo "$d no longer exists" >&2
            fi
        else
            local reply
            reply=$(echo "$REPLY" | tr '[:upper:]' '[:lower:]')
            if [ "$reply" = 'q' ]
            then
                return
            elif [ "$reply" = '-' ]
            then
                # shellcheck disable=SC2164
                builtin cd -
                return
            else
                echo "'$REPLY' is an invalid choice"
            fi
        fi
    done
}
