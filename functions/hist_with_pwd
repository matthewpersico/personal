# -*- sh -*-

# <Function Class: hist>

hist_with_pwd ()
{
    echo "${FUNCNAME[0]} \"$@\" ## $(date +%Y%m%d%H%M%S)" >> ${HOME}/personal/data/funcsaudit ## This is audit
    perl -an -e 'BEGIN{@out=()};
 if( $_ =~ m/^#([0-9]+)( ## pwd => (.*))*/ ) {
 push @out, {time=$1, pwd=$3};
 } else {
 $out[-1]->{cmd} = $_;
 }
 END {
 $idxfmt="%" . scalar(split(//,scalar(@out))) . "d";

 @out
 printf($idxfmt . ": %s %s %s",
         $., $_);' $HISTFILE
}


