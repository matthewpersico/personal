#!/usr/bin/env bash

# ghe-from-gh

# Put changes made on gh onto ghe
if [[ $1 =~ ^-+h ]] \
   || [[ -z $1 ]]; then
    cat <<'EOU'
usage: ghe-from-gh <branch>

Take commits on a GitHub.com branch and propigate them to a GitHub Enterprise branch.

- <branch>

  The branch name is used to reference two branches:

  * gh-<branch>, a local branch tracking the remote 'gh/<branch>'.
    'gh' is assumed to be set up as a remote reference to the
    GitHub.com repository.

  * <branch>, a local branch tracking the remote 'origin/<branch>'.
    'origin' is assumed to be set up as a remote reference to the
    GitHub Enterprise repository.

  The commits on 'gh-<branch>' are rebased onto the head of '<branch>'.

After testing you can then propigate to all changes on '<branch>' to the other
branches in the GitHub Enterprise repo with the command:

  git branch --sync <branch> origin

which must be run in a clone of the GitHub Enterprise repo.

EOU
    exit 0
fi

git-branch --sync "gh-$1" "origin/$1"
