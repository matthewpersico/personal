#!/usr/bin/env bash

declare -a repos
repos=(
    "$HOME/personal"
    "$HOME/.emacs.d/taps/$USER"
    "$HOME/examples"
    "$HOME/.git_template"
)

for repo in "${repos[@]}"
do
    (
        cd "$repo" || exit 1
        echo "**** $(pwd) ****"
        echo "---- git status ----"
        if git status
        then
            declare output
            output=$(mktemp -t tmp."$(basename "$0")".git-diff.XXXXXXXXXX)
            if ! git diff --name-only origin/master >"$output" 2>&1
            then
                echo "---- git diff origin/master ----"
                cat "$output"
                rm -rf "$output"
            fi
        fi
    )
done
