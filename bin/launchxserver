#!/usr/bin/env bash

# launchxserver

if [[ "$1" = '--silent' ]]; then
    exec 1>>/dev/null
    exec 2>>/dev/null
fi

if [[ "$(uname -r | tr '[:upper:]' '[:lower:]' | sed 's/.*\(microsoft\).*/\1/')" = 'microsoft' ]]; then
    wh=$(winhome)
    declare cmount
    cmount=$(df | grep C:  | cols --keep -1)
    # shellcheck disable=SC1117 # the backslashes will be fine in Windows process space.
    "$cmount"/Program\ Files/VcXsrv/xlaunch.exe -run "$wh\local\bin\config.xlaunch"
    exit $?
else
    echo "Not Microsoft WSL. Cannot launch an X server, shouldn't even call this on a UNIX box."
    exit 1
fi
