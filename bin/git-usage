#!/usr/bin/env bash

# git-usage

# Perform usage on local git command and then on same real git command.  $1 is
# the full path to the git command git-<gitsubcmd>.
(
    declare gitsubcmd
    if [[ $1 == '--real' ]]; then
        gitsubcmd=$2
        shift;shift
    fi

    declare tgt=$1;shift
    [[ -n "$*" ]] && cmd-echo -- "$@"
    echo "** Extended actions **"
    bash-usage "$tgt"
    echo
    echo "** Standard actions **"
    [[ -z $gitsubcmd ]] && gitsubcmd=$(basename "$tgt" | sed 's/git-//')
    # special case
    if [[ $gitsubcmd == 'git' ]]; then
        man git
    else
        "$REALGIT" "$gitsubcmd" --help
    fi
) 2>&1 | ${PAGER:-less}
