#!/usr/bin/env perl

# git-version-verify - no .gitaudit, called on every prompt

use strict;
use warnings;

my @git_version_i = split( /\s+/, qx($ENV{REALGIT} --version) );
my @git_version   = split( /\./,  $git_version_i[-1] );
my @git_version_verified_i =
  split( /\s+/, $ENV{REALGIT_VERIFIED_VERSION_STRING} );
my @git_version_verified = split( /\./, $git_version_verified_i[-1] );

for my $index ( 0, 1, 2 ) {
    next if ( $git_version[$index] == $git_version_verified[$index] );
    my $msg =
"Verified to $git_version_verified_i[-1], but $git_version_i[-1] is installed.\n";
    if ( $git_version[$index] > $git_version_verified[$index] ) {
        die ">>> $ARGV[0]:ERROR:$msg";
    } elsif ( $git_version[$index] < $git_version_verified[$index] ) {
        warn ">>> $ARGV[0]:WARNING:$msg";
        exit 0;
    }
}
exit 0;
